## 1.1 测度与概率（σ-代数、Radon 测度、弱收敛）

> 本节建立本书后续所需的测度与概率基础：从 σ-代数与测度出发，进入 Radon 测度与弱收敛，并给出与 TCIG 直接相关的范式（图上的经验测度、推前测度、紧致性与紧性）。

---

### 1.1.1 可测空间与概率空间

**定义 1.1（σ-代数）**  
设集合 \(X\)。子集族 \(\mathcal{F}\subset 2^X\) 称为 \(X\) 上的 **σ-代数**，若满足：
1) \(X\in\mathcal{F}\)；  
2) 若 \(A\in\mathcal{F}\) 则 \(A^c\in\mathcal{F}\)；  
3) 对任意可数族 \(\{A_n\}\subset\mathcal{F}\)，有 \(\bigcup_{n}A_n\in\mathcal{F}\)。

\((X,\mathcal{F})\) 称为**可测空间**。拓扑空间 \((X,\tau)\) 的 **Borel σ-代数** \(\mathcal{B}(X)\) 为由开集生成的最小 σ-代数。

**定义 1.2（测度/概率测度）**  
\((X,\mathcal{F})\) 上的映射 \(\mu:\mathcal{F}\to[0,\infty]\) 若对互不相交的可数并满足
\[
\mu\!\left(\bigsqcup_{n=1}^\infty A_n\right)=\sum_{n=1}^\infty \mu(A_n),
\]
则称为**测度**。若 \(\mu(X)=1\) 则称为**概率测度**，\((X,\mathcal{F},\mu)\) 为**概率空间**。

**例 1.3（Dirac 测度）**  
对 \(x\in X\)，\(\delta_x(A)=\mathbf{1}_{\{x\in A\}}\)。它是概率测度；在 TCIG 中，事件点 \(v\in V\) 常用 \(\delta_v\) 表示“发生在节点 \(v\)”的质量。

**定义 1.4（可测函数/随机变量）**  
在可测空间 \((X,\mathcal{F})\)、\((Y,\mathcal{G})\) 上，函数 \(f:X\to Y\) 称**可测**，若对任意 \(B\in\mathcal{G}\) 有 \(f^{-1}(B)\in\mathcal{F}\)。  
在概率空间上，取 \(Y=\mathbb{R}^d\) 与 \(\mathcal{G}=\mathcal{B}(\mathbb{R}^d)\)，可测函数称为**随机变量**。

---

### 1.1.2 积分与期望

**定义 1.5（Lebesgue 积分/期望）**  
对非负可测函数 \(f\ge0\)，定义 \(\int f\,\mathrm{d}\mu\) 为简单函数极限；一般 \(f\) 分解为正负部后定义。  
在概率空间上，记 \(\mathbb{E}_\mu[f]=\int f\,\mathrm{d}\mu\)。

**基本定理**  
- **单调收敛定理（MCT）**：若 \(0\le f_n\uparrow f\) 几乎处处，则 \(\int f_n\,\mathrm{d}\mu \uparrow \int f\,\mathrm{d}\mu\)。  
- **受控收敛定理（DCT）**：若 \(f_n\to f\) 几乎处处，且 \(|f_n|\le g\in L^1(\mu)\)，则 \(\int f_n\to\int f\)。  
- **Fatou 引理**：\(\int \liminf f_n \le \liminf \int f_n\)。

这些定理是后续建立**弱收敛 ⇒ 期望收敛（对连续有界/可积函数）**的关键工具。

---

### 1.1.3 推前测度与分布

**定义 1.6（推前测度 / 图像测度）**  
\(T:(X,\mathcal{F})\to(Y,\mathcal{G})\) 可测，\(\mu\) 为 \(X\) 上测度。定义
\[
T_\#\mu(B)=\mu(T^{-1}(B)),\quad B\in\mathcal{G}.
\]
在概率论中，若 \(X\sim\mu\)，则 \(T(X)\) 的分布为 \(T_\#\mu\)。

**例 1.7（TCIG 中的时间/因果推前）**  
因果时图 \(\mathcal{G}=(V,E,\tau)\) 上的时间推进算子 \(\Phi_t:V\to V\)（把事件送往其“\(t\)”步可达的节点），可定义 \(\mu_t=(\Phi_t)_\#\mu_0\) 描述“质量随因果流动”的分布演化。

---

### 1.1.4 Radon 测度与正则性

**定义 1.8（Radon 测度）**  
在局部紧 Hausdorff 空间 \(X\) 上，Borel 测度 \(\mu\) 若满足  
(i) **内正则**：对任意 Borel 集 \(A\)，\(\mu(A)=\sup\{\mu(K):K\subset A,\ K\text{紧}\}\)；  
(ii) **外正则**：\(\mu(A)=\inf\{\mu(U):A\subset U,\ U\text{开}\}\)；  
则称 **Radon 测度**。

**事实**  
- \(\mathbb{R}^d\) 上所有有限 Borel 测度都是 Radon。  
- **Riesz 表示定理（略述）**：在 \(C_c(X)\) 的对偶可由唯一 Radon 测度表示（正线性泛函 ↔ Radon 测度）。

**意义**  
Radon 性保证“紧集近似”“开外逼近”，便于在拓扑-几何对象（流形、图的几何实现）上进行极限与变分。

---

### 1.1.5 弱收敛（分布收敛）

**定义 1.9（弱收敛）**  
度量空间 \(X\) 上的概率测度列 \(\{\mu_n\}\) 对 \(\mu\) **弱收敛**（记 \(\mu_n \Rightarrow \mu\)），若对所有有界连续函数 \(f\in C_b(X)\),
\[
\int f\,\mathrm{d}\mu_n \longrightarrow \int f\,\mathrm{d}\mu.
\]

**Portmanteau 定理（等价刻画，要点）**  
以下命题等价：  
(a) \(\mu_n \Rightarrow \mu\)。  
(b) 对一切闭集 \(F\)，\(\limsup_n \mu_n(F)\le \mu(F)\)。  
(c) 对一切开集 \(G\)，\(\liminf_n \mu_n(G)\ge \mu(G)\)。  
(d) 对一切 \(\mu(\partial A)=0\) 的 Borel 集 \(A\)，\(\mu_n(A)\to\mu(A)\)。

**紧性与相对紧性**  
- **紧性（Tightness）**：\(\{\mu_n\}\) 紧，若对任意 \(\varepsilon>0\)，存在紧集 \(K\subset X\) 使 \(\sup_n \mu_n(K^c)<\varepsilon\)。  
- **Prokhorov 定理（要点）**：在完备可分度量空间（Polish 空间）上，\(\{\mu_n\}\) 紧 ⇔ 相对弱紧；即存在子列弱收敛。

**Skorokhod 表示（要点）**  
若 \(\mu_n \Rightarrow \mu\) 且 \(X\) 为 Polish，则存在随机变量 \(X_n,X\) 定义在同一概率空间上，\(\mathcal{L}(X_n)=\mu_n\)、\(\mathcal{L}(X)=\mu\)，并且 \(X_n\to X\) 几乎处处（经恰当构造）。  
> 在 TCIG 的数值实验中常用它把“分布收敛”转成“样本路径收敛”的直观。

---

### 1.1.6 收敛方式之间的关系（速览）

- **几乎处处收敛** ⇒ **依概率收敛** ⇒ **按分布收敛（弱收敛）**。逆命题一般不成立。  
- 在 \(\mathbb{R}^d\) 上，若 \(X_n\to X\) 依概率且 \(|X_n|\le Y\in L^1\) 一致可积，则 \(\mathbb{E}[X_n]\to \mathbb{E}[X]\)（由 DCT）。

---

### 1.1.7 与最优传输/度量化的联系

弱收敛可由若干“概率度量”度量化：
- **Levy–Prokhorov 距离** \(d_{LP}\) 与弱收敛等价。  
- **Bounded-Lipschitz 距离** \(d_{BL}\)：  
\[
d_{BL}(\mu,\nu)=\sup_{\|f\|_\infty\le1,\ \mathrm{Lip}(f)\le1}\left|\int f\,\mathrm{d}\mu-\int f\,\mathrm{d}\nu\right|
\]
与弱收敛等价（在 Polish 空间）。  
- **Wasserstein 距离** \(W_p\)（\(p\ge1\)）：若 \(\{\mu_n\}\) \(p\)-阶矩一致有界，则 \(W_p(\mu_n,\mu)\to0 \Rightarrow \mu_n\Rightarrow \mu\)。  
> 在 TCIG 中我们将引入**因果-Wasserstein** \(W_c\)，它与弱收敛的关系需额外的因果约束与紧性条件（见第 4–5 章）。

---

### 1.1.8 乘积测度、Fubini/Tonelli

- **Tonelli**：若 \(f\ge0\)，则可交换积分与可数和/次序：  
\(\displaystyle \int f\,\mathrm{d}(\mu\times\nu)=\int\!\big(\int f\,\mathrm{d}\nu\big)\mathrm{d}\mu=\int\!\big(\int f\,\mathrm{d}\mu\big)\mathrm{d}\nu\)。  
- **Fubini**：若 \(f\in L^1(\mu\times\nu)\)，同样成立。  
> 在因果时图的“层-时间 × 节点”笛卡尔结构里，乘积测度与 Fubini 保证我们可以按“时间→空间”或“空间→时间”交换求积（第 7 章热核视角会用到）。

---

### 1.1.9 TCIG 相关范式与例子

**例 1.10（时间经验测度）**  
给定事件序列 \(\{v_t\}_{t=1}^T\subset V\)，定义经验测度  
\[
\hat\mu_T=\frac1T\sum_{t=1}^T \delta_{v_t}.
\]
当 \(T\to\infty\) 时，若过程遍历且稳定，则 \(\hat\mu_T \Rightarrow \mu_\infty\)（极限分布）。这支撑了“曲率/距离”的统计估计。

**例 1.11（因果推前）**  
设 \(\Phi:\ V\to V\) 为“沿因果边一步推进”的可测映射，\(\mu_{k+1}=\Phi_\#\mu_k\)。在离散时间下，\(\{\mu_k\}\) 的紧性确保存在子列弱极限；若曲率正且有收缩，则 \(\mu_k\) 收敛到不动分布（见 6.3 节）。

**例 1.12（Radon 正则化）**  
将有限图 \(V\) 嵌入 \(\mathbb{R}^d\) 的几何实现 \(|V|\) 并赋予子空间拓扑，则在 \(\mathcal{B}(|V|)\) 上自然得到 Radon 概率测度（点质量或核平滑）。  
这使得“图极限 \(\Rightarrow\) 流形极限”的弱收敛论证成立（见 12.2 节的 GH 极限讨论）。

---

### 1.1.10 小结与实践准则

- **弱收敛=对连续有界测试函数的积分收敛**；工程上用 \(d_{BL}\)/\(d_{LP}\) 或 \(W_p\)（有矩条件）数值度量。  
- **Radon 正则性** 保证紧集逼近、开集外逼；对几何对象尤为关键。  
- **推前测度** 把“动力学/因果演化”转为“分布演化”；  
- **紧性/Prokhorov** 是处理大样本/长时间极限的核心工具。

---

### 1.1.11 练习（选做）

1) （Portmanteau 应用）在 \(\mathbb{R}\) 上，设 \(\mu_n=\mathcal{N}(0,1+\tfrac1n)\)。证明 \(\mu_n\Rightarrow \mathcal{N}(0,1)\)。  
2) （紧性判据）设 \(\{\mu_n\}\) 为 \(\mathbb{R}^d\) 上概率测度，且 \(\sup_n\int \|x\|^p\,\mathrm{d}\mu_n(x)<\infty\)（某 \(p>0\)）。证明 \(\{\mu_n\}\) 紧。  
3) （推前与弱收敛）若 \(\mu_n\Rightarrow \mu\) 且 \(T\) 连续，证 \(T_\#\mu_n \Rightarrow T_\#\mu\)。  
4) （Radon 性）证明：\(\mathbb{R}^d\) 上有限 Borel 测度是 Radon。  
5) （经验测度）设 i.i.d. 样本 \(X_1,\dots,X_n\sim\mu\)，经验测度 \(\hat\mu_n=\frac1n\sum_{i=1}^n\delta_{X_i}\)。证明 \(\hat\mu_n\Rightarrow \mu\)（提示：Glivenko–Cantelli 或 VC 理论的弱形式）。

---
## 1.2 几何与拓扑（度量/测地、流形、曲率直觉）

> 本节给出将“时间因果信息几何（TCIG）”落在几何与拓扑框架中的最小公设：从度量空间与测地、到可微流形与黎曼度量、再到曲率的直观与离散对应。我们强调“与算法可实现性”相关的概念（长度空间、GH 极限、离散曲率），为第 4–7 章的因果-OT 与谱视角铺垫。

---

### 1.2.1 度量空间与长度结构

**定义 1.2.1（度量空间）**  
\((X,d)\) 为度量空间，若 \(d:X\times X\to[0,\infty)\) 满足：  
(i) 正定；(ii) 对称；(iii) 三角不等式。

**定义 1.2.2（曲线长度与长度空间）**  
曲线 \(\gamma:[a,b]\to X\) 的长度
\[
L(\gamma)=\sup_{\Pi}\sum_{i} d\big(\gamma(t_i),\gamma(t_{i+1})\big),
\]
上确界对所有划分 \(\Pi:a=t_0<\cdots<t_k=b\)。若任意两点 \(x,y\) 的距离等于某条曲线的最小长度，即
\[
d(x,y)=\inf_{\gamma(a)=x,\ \gamma(b)=y} L(\gamma),
\]
则 \((X,d)\) 称为**长度空间**。

**定义 1.2.3（测地/测地空间）**  
若对任意 \(x,y\) 存在参数化长度最小的曲线 \(\gamma\) 使 \(L(\gamma)=d(x,y)\)，称 \(\gamma\) 为**测地**（geodesic），\((X,d)\) 为**测地空间**。

**要点**  
- 长度/测地结构使“最优传输的地质线”“热核的扩散前沿”有几何意义。  
- TCIG 中的因果-Wasserstein 距离 \(W_c\) 期望在适当条件下诱导**（拟）长度结构**，见 5.1 与 6.1。

---

### 1.2.2 拓扑概念速览（与统计/极限相关）

**紧致、完备、全有界**  
- **完备**：柯西列收敛。  
- **全有界**：对任意 \(\varepsilon>0\) 可有限个 \(\varepsilon\)-球覆盖。  
- **定理（Heine–Borel 型）**：完备+全有界 ⇒ **紧致**。紧致保结构稳定、极值存在与弱收敛良性。

**连通与路径连通**  
路径连通 ⇒ 连通；在长度空间两者等价。TCIG 中连通意味着“信息在因果网络中可达”。

**Gromov–Hausdorff（GH）距离与极限**  
- 两紧致度量空间 \((X,d_X),(Y,d_Y)\) 的 GH 距离度量“同胚无关的形变差异”。  
- 在 TCIG 中用于：**离散因果图 → 连续流形** 的极限（12.2 节）。

---

### 1.2.3 可微流形与黎曼度量

**定义 1.2.4（可微流形）**  
\(n\) 维可微流形 \(M\) 是二可分 Hausdorff 空间，局部同胚于 \(\mathbb{R}^n\)，并配有 \(C^\infty\) 相容的图册 \(\{(U_\alpha,\varphi_\alpha)\}\)。

**切空间与向量场**  
点 \(p\in M\) 的切空间 \(T_pM\) 为经过 \(p\) 的曲线等价类的线性化；向量场是 \(p\mapsto v(p)\in T_pM\) 的光滑选择。

**定义 1.2.5（黎曼度量与长度）**  
黎曼度量 \(g\) 给每个 \(p\) 一个内积 \(\langle\cdot,\cdot\rangle_p\) 于 \(T_pM\)。曲线 \(\gamma\) 的长度
\[
L(\gamma)=\int_a^b \sqrt{\,\langle \dot\gamma(t),\dot\gamma(t)\rangle_{\gamma(t)}\,}\,dt,
\]
诱导距离 \(d_g(x,y)=\inf L(\gamma)\)。\((M,g)\) 成为测地空间。

**测地方程与 Levi-Civita 连接**  
唯一与 \(g\) 相容且无挠的联络 \(\nabla\) 称 **Levi-Civita 连接**。测地满足 \(\nabla_{\dot\gamma}\dot\gamma=0\)。  
**Hopf–Rinow（要点）**：\((M,g)\) 完备 ⇔ 任意两点有最短测地；闭有界集紧。

**与 TCIG 的关系**  
- 当离散因果结构在极限下收敛到 \((M,g)\) 时，**信息传播的最短路径**与曲率性质可由 \(g\) 控制（6–8 章）。  
- \(g\) 的作用类比 OT 中的代价张量；在 5.4 我们会比较 \(W_c\) 与 Riemannian \(W_2\)。

---

### 1.2.4 曲率的直觉：从平面到高维、从连续到离散

**截面曲率 \(K\)**  
在二维切平面上的曲率，决定“小三角形的角和”与体积增长：  
- \(K>0\)：球面型，测地趋向汇聚，体积增长慢；  
- \(K=0\)：欧几里得型；  
- \(K<0\)：鞍面型，测地发散，体积增长快。

**Ricci 曲率 \(\mathrm{Ric}\)**  
对各方向截面曲率的“平均”，控制体积元素、热核、随机游走的扩散速率。**正 Ricci** ⇒ 扩散收缩、混合快。

**标量曲率 \(S\)**  
Ricci 的迹，描述总体弯曲强弱的标量指示。

**合成曲率（CD(K,N)）与 LSV 框架**  
Lott–Sturm–Villani 用最优传输与熵的 \(\lambda\)-凸性定义“Ricci ≥ K”的**合成**版本，超越光滑流形。  
> 在 TCIG 中，我们以**因果-Wasserstein** \(W_c\) 的熵凸性定义“因果信息曲率” \(\kappa_c\)（见 5.1–5.5），其直观与 Ricci 收缩一致。

**离散/图上的曲率**  
- **Ollivier–Ricci 曲率**：两点邻域分布在 \(W_1\) 意义下“靠拢程度”。  
- **Forman 曲率**：基于胞腔复形的组合定义。  
- **谱缺口与曲率**：正曲率常与较大谱缺口/快速混合对应（7.3 节详述）。  
> TCIG 将以“因果邻域 + 因果耦合”定义**带方向性的曲率**，支撑第 8 章的浓缩与 Talagrand 型不等式。

---

### 1.2.5 例子与图景

**例 1（欧氏 & 球面 & 双曲）**  
\((\mathbb{R}^n,\delta)\)：\(K=0\)；\(\mathbb{S}^n\)：\(K>0\)；\(\mathbb{H}^n\)：\(K<0\)。  
热核扩散：球面更“易收缩”，双曲更“易发散”，与信息聚散相呼应。

**例 2（树与扩展图）**  
正则树的“负曲率直觉”体现为随机游走逃逸率高；高扩展（Ramanujan）图谱缺口大，混合快，类比正曲率效应。

**例 3（因果有向图的“曲率”）**  
在只允许前向边的因果图上，构造“前向邻域分布”，比较其经一跳推进的 \(W_1/W_2/W_c\) 距离收缩率，得到方向性曲率指标（7.2–7.4）。

---

### 1.2.6 与 TCIG 的工作假设（非正式）

- **H1（可达与测地）**：在合适的因果-OT 代价下，\((\mathcal{P}(X),W_c)\) 至少是拟长度空间，存在“因果地质线”。  
- **H2（正曲率⇒收缩）**：若 \(\kappa_c\ge K>0\)，则热核/扩散半群与因果随机游走呈指数收缩，产生谱缺口下界。  
- **H3（离散→连续）**：高密度因果图在 GH 意义下收敛到带时间向量场的流形，\(\kappa_c\) 极限对应信息-Ricci。

这些假设将通过第 6–8 章的定理、数值证据与应用实例加以论证或限定。

---

### 1.2.7 小结
- **度量 + 长度/测地**：为“最优输运/扩散/地质线”提供统一语义。  
- **流形 + 黎曼度量**：给出可微框架，连接 PDE/热核/随机过程。  
- **曲率直觉**：收敛/发散、混合/浓缩，与 OT-熵凸性、谱缺口紧密平行。  
- **离散到连续**：GH 极限与离散曲率使 TCIG 可在图与流形之间迁移。

---

### 1.2.8 练习（选做）
1) 证明：长度空间中路径连通 ⇔ 连通。  
2) 在 \(\mathbb{R}^n\) 上给定光滑正定张量场 \(g\)，写出测地方程的局部形式（Christoffel 符号）。  
3) 设 \((X,d)\) 为紧致测地空间，证明任意两点存在最短测地。  
4) 计算单位圆 \(S^1\) 的测地与其长度；解释其 GH 极限与多边形环的关系。  
5) 证明：Ollivier–Ricci 曲率为正 ⇒ 随机游走的 1-Wasserstein 收缩；给出两层图上的反例或边界条件。  
6) 设一族因果图的节点密度 \(\to\infty\)，边长尺度 \(\to 0\)，尝试给出其收敛到 \((M,g)\) 的充分条件（提示：双有界度量与一致正则覆盖）。

---
